// CounsellorClientController.java
package com.moodyclues.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.moodyclues.model.HabitsEntry;
import com.moodyclues.model.JournalEntry;
import com.moodyclues.model.JournalUser;
import com.moodyclues.service.CounsellorService;

import jakarta.servlet.http.HttpSession;

@RestController
@RequestMapping("/api/counsellor/clients")
public class CounsellorClientController {

    @Autowired
    CounsellorService cService;

    @GetMapping
    public List<JournalUser> listClients(HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        return service.listClients(counsellorId);
    }

    @GetMapping("/{journalUserId}/journal-entries")
    public List<JournalEntry> listClientJournalEntries(@PathVariable String journalUserId,
                                                       HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        return service.listClientJournalEntries(counsellorId, journalUserId);
    }

    @GetMapping("/{journalUserId}/habits-entries")
    public List<HabitsEntry> listClientHabitsEntries(@PathVariable String journalUserId,
                                                     HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        return service.listClientHabitsEntries(counsellorId, journalUserId);
    }

    @GetMapping("/{journalUserId}/journal-entries/{entryId}")
    public JournalEntry getJournalEntry(@PathVariable String journalUserId,
                                        @PathVariable String entryId,
                                        HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        return service.getJournalEntry(counsellorId, journalUserId, entryId);
    }

    @GetMapping("/{journalUserId}/habits-entries/{entryId}")
    public HabitsEntry getHabitsEntry(@PathVariable String journalUserId,
                                      @PathVariable String entryId,
                                      HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        return service.getHabitsEntry(counsellorId, journalUserId, entryId);
    }
}

