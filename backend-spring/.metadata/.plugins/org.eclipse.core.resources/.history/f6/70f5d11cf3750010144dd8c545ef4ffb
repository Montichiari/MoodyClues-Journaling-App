package com.moodyclues.controller;

import java.util.List;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import com.moodyclues.model.HabitsEntry;
import com.moodyclues.model.JournalEntry;
import com.moodyclues.model.JournalUser;
import com.moodyclues.service.CounsellorService;

import jakarta.servlet.http.HttpSession;

@RestController
@RequestMapping("/api/counsellor/clients")
public class CounsellorClientController {

    private final CounsellorService cService;

    public CounsellorClientController(CounsellorService cService) {
        this.cService = cService;
    }

    @GetMapping("/all")
    public ResponseEntity<?> listClients(HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        List<JournalUser> clients = cService.listClients(counsellorId);
        return new ResponseEntity<>(clients, HttpStatus.OK);
    }
    
    @GetMapping("/all/{counsellorId}")
    public ResponseEntity<?> listClientsAndroid(@PathVariable String counsellorId) {
        List<JournalUser> clients = cService.listClients(counsellorId);
        return new ResponseEntity<>(clients, HttpStatus.OK);
    }

    @GetMapping("/{journalUserId}/journal-entries")
    public ResponseEntity<?> listClientJournalEntries(@PathVariable String journalUserId,
                                                      HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        List<JournalEntry> entries = cService.listClientJournalEntries(counsellorId, journalUserId);
        return new ResponseEntity<>(entries, HttpStatus.OK);
    }
    
    @GetMapping("/{journalUserId}/journal-entries/{counsellorId}")
    public ResponseEntity<?> listClientJournalEntriesAndroid(@PathVariable String journalUserId,
                                                      @PathVariable String counsellorId) {
        List<JournalEntry> entries = cService.listClientJournalEntries(counsellorId, journalUserId);
        return new ResponseEntity<>(entries, HttpStatus.OK);
    }

    @GetMapping("/{journalUserId}/habits-entries")
    public ResponseEntity<?> listClientHabitsEntries(@PathVariable String journalUserId,
                                                     HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        List<HabitsEntry> entries = cService.listClientHabitsEntries(counsellorId, journalUserId);
        return new ResponseEntity<>(entries, HttpStatus.OK);
    }
    
    @GetMapping("/{journalUserId}/habits-entries/{counsellorId}")
    public ResponseEntity<?> listClientHabitsEntriesAndroid(@PathVariable String journalUserId,
                                                     @PathVariable String counsellorId) {
        List<HabitsEntry> entries = cService.listClientHabitsEntries(counsellorId, journalUserId);
        return new ResponseEntity<>(entries, HttpStatus.OK);
    }

    @GetMapping("/{journalUserId}/journal-entries/{entryId}")
    public ResponseEntity<?> getJournalEntry(@PathVariable String journalUserId,
                                             @PathVariable String entryId,
                                             HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        JournalEntry entry = cService.getJournalEntry(counsellorId, journalUserId, entryId);
        return new ResponseEntity<>(entry, HttpStatus.OK);
    }
    
    @GetMapping("/{journalUserId}/journal-entries/{entryId}/{counsellorId}")
    public ResponseEntity<?> getJournalEntry(@PathVariable String journalUserId,
                                             @PathVariable String entryId,
                                             @PathVariable String counsellorId) {
        JournalEntry entry = cService.getJournalEntry(counsellorId, journalUserId, entryId);
        return new ResponseEntity<>(entry, HttpStatus.OK);
    }

    @GetMapping("/{journalUserId}/habits-entries/{entryId}")
    public ResponseEntity<?> getHabitsEntry(@PathVariable String journalUserId,
                                            @PathVariable String entryId,
                                            HttpSession session) {
        String counsellorId = (String) session.getAttribute("id");
        HabitsEntry entry = cService.getHabitsEntry(counsellorId, journalUserId, entryId);
        return new ResponseEntity<>(entry, HttpStatus.OK);
    }
}
